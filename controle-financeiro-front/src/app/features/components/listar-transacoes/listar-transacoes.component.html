<div class="transacoes-container">
  <h2>Transações</h2>

  <!-- Acordeão para filtro -->
  <div class="acordeao-filtro">
    <button
      type="button"
      class="acordeao-toggle"
      (click)="mostrarFiltro = !mostrarFiltro"
    >
      {{ mostrarFiltro ? "Fechar" : "Filtrar por Data" }}
    </button>
    <div class="acordeao-conteudo" *ngIf="mostrarFiltro">
      <form (ngSubmit)="filtrarTransacoes()" class="filtro-form">
        <label>
          Mês:
          <input
            type="text"
            maxlength="2"
            pattern="^(0?[1-9]|1[0-2])$"
            [(ngModel)]="mesSelecionado"
            name="mes"
            required
            placeholder="MM"
          />
        </label>
        <label>
          Ano:
          <input
            type="text"
            maxlength="4"
            pattern="^[0-9]{4}$"
            [(ngModel)]="anoSelecionado"
            name="ano"
            required
            placeholder="AAAA"
          />
        </label>
        <button type="submit">Filtrar</button>
        <button type="button" (click)="limparFiltro()">Limpar Filtro</button>
      </form>
    </div>
  </div>

  <div *ngIf="errorMessage" class="error-message">{{ errorMessage }}</div>

  <div class="transacoes">
    <!-- Receitas -->
    <div class="receitas">
      <h3>Receitas</h3>
      <table *ngIf="receitas.length > 0" class="tabela-transacoes">
        <thead>
          <tr>
            <th>Descrição</th>
            <th>Valor</th>
            <th>Data</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let receita of receitas">
            <td>{{ receita.descricao }}</td>
            <td>{{ receita.valor | currency }}</td>
            <td>
              <div class="date-cell">
                <span class="date">{{ receita.dataTransacao }}</span>
                <button
                  type="button"
                  class="icon-btn"
                  title="Excluir transação"
                  (click)="pedirExclusao(receita)"
                >
                  <img src="assets/img/iconeLixeira.png" alt="Excluir" />
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
      <p *ngIf="receitas.length === 0">Nenhuma receita encontrada.</p>
    </div>

    <!-- Despesas -->
    <div class="despesas">
      <h3>Despesas</h3>
      <table *ngIf="despesas.length > 0" class="tabela-transacoes">
        <thead>
          <tr>
            <th>Descrição</th>
            <th>Valor</th>
            <th>Data</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let despesa of despesas">
            <td>{{ despesa.descricao }}</td>
            <td>{{ despesa.valor | currency }}</td>
            <td>
              <div class="date-cell">
                <span class="date">{{ despesa.dataTransacao }}</span>
                <button
                  type="button"
                  class="icon-btn"
                  title="Excluir transação"
                  (click)="pedirExclusao(despesa)"
                >
                  <img src="assets/img/iconeLixeira.png" alt="Excluir" />
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
      <p *ngIf="despesas.length === 0">Nenhuma despesa encontrada.</p>
    </div>
  </div>
</div>
<div
  class="modal-backdrop"
  *ngIf="showConfirm"
  (click)="cancelarExclusao()"
></div>
<div class="modal" *ngIf="showConfirm" role="dialog" aria-modal="true">
  <div class="modal__content">
    <button
      class="modal__close"
      type="button"
      (click)="cancelarExclusao()"
      aria-label="Fechar"
    >
      ×
    </button>
    <h4>Confirmar exclusão</h4>
    <p>
      Tem certeza que deseja excluir a transação
      <strong>{{ transacaoParaExcluir?.descricao }}</strong
      >?
    </p>
    <div class="modal__actions">
      <button type="button" class="btn-secondary" (click)="cancelarExclusao()">
        Cancelar
      </button>
      <button type="button" class="btn-danger" (click)="confirmarExclusao()">
        Excluir
      </button>
    </div>
  </div>
</div>
